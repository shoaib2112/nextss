angular.module("rzModule", []).run(["$templateCache", function (t) { "use strict"; var e = '<span class="rz-bar-wrapper"><span class="rz-bar"></span></span><span class="rz-bar rz-selection"></span><span class="rz-pointer"></span><span class="rz-pointer"></span><span class="rz-bubble rz-limit"></span><span class="rz-bubble rz-limit"></span><span class="rz-bubble"></span><span class="rz-bubble"></span><span class="rz-bubble"></span>'; t.put("rzSliderTpl.html", e) }]).value("throttle", function (t, e, i) { "use strict"; var n, s, r, a = Date.now || function () { return (new Date).getTime() }, o = null, l = 0; i = i || {}; var u = function () { l = i.leading === !1?0:a(), o = null, r = t.apply(n, s), n = s = null }; return function () { var d = a(); l || i.leading !== !1 || (l = d); var h = e - (d - l); return n = this, s = arguments, h > 0?o || i.trailing === !1 || (o = setTimeout(u, h)):(clearTimeout(o), o = null, l = d, r = t.apply(n, s), n = s = null), r } }).factory("RzSlider", ["$timeout", "$document", "$window", "throttle", function (t, e, i, n) { "use strict"; var s = function (t, e, i) { this.scope = t, this.attributes = i, this.sliderElem = e, this.range = void 0 !== i.rzSliderHigh && void 0 !== i.rzSliderModel, this.handleHalfWidth = 0, this.alwaysShowBar = !!i.rzSliderAlwaysShowBar, this.maxLeft = 0, this.precision = 0, this.step = 0, this.tracking = "", this.minValue = 0, this.maxValue = 0, this.hideLimitLabels = !!i.rzSliderHideLimitLabels, this.presentOnly = "true" === i.rzSliderPresentOnly, this.valueRange = 0, this.initHasRun = !1, this.customTrFn = this.scope.rzSliderTranslate() || function (t) { return t + "" }, this.deRegFuncs = [], this.fullBar = null, this.selBar = null, this.minH = null, this.maxH = null, this.flrLab = null, this.ceilLab = null, this.minLab = null, this.maxLab = null, this.cmbLab = null, this.init() }; return s.prototype = { init: function () { var e, s, r, a = angular.bind(this, this.calcViewDimensions), o = this; this.initElemHandles(), this.calcViewDimensions(), this.setMinAndMax(), this.precision = void 0 === this.scope.rzSliderPrecision?0:+this.scope.rzSliderPrecision, this.step = void 0 === this.scope.rzSliderStep?1:+this.scope.rzSliderStep, t(function () { o.updateCeilLab(), o.updateFloorLab(), o.initHandles(), o.presentOnly || o.bindEvents() }), r = this.scope.$on("reCalcViewDimensions", a), this.deRegFuncs.push(r), angular.element(i).on("resize", a), this.initHasRun = !0, e = n(function () { o.setMinAndMax(), o.updateLowHandle(o.valueToOffset(o.scope.rzSliderModel)), o.updateSelectionBar(), o.range && o.updateCmbLabel() }, 350, { leading: !1 }), s = n(function () { o.setMinAndMax(), o.updateHighHandle(o.valueToOffset(o.scope.rzSliderHigh)), o.updateSelectionBar(), o.updateCmbLabel() }, 350, { leading: !1 }), this.scope.$on("rzSliderForceRender", function () { o.resetLabelsValue(), e(), o.range && s(), o.resetSlider() }), r = this.scope.$watch("rzSliderModel", function (t, i) { t !== i && e() }), this.deRegFuncs.push(r), r = this.scope.$watch("rzSliderHigh", function (t, e) { t !== e && s() }), this.deRegFuncs.push(r), this.scope.$watch("rzSliderFloor", function (t, e) { t !== e && o.resetSlider() }), this.deRegFuncs.push(r), r = this.scope.$watch("rzSliderCeil", function (t, e) { t !== e && o.resetSlider() }), this.deRegFuncs.push(r), this.scope.$on("$destroy", function () { o.minH.off(), o.maxH.off(), angular.element(i).off("resize", a), o.deRegFuncs.map(function (t) { t() }) }) }, resetSlider: function () { this.setMinAndMax(), this.calcViewDimensions(), this.updateCeilLab(), this.updateFloorLab() }, resetLabelsValue: function () { this.minLab.rzsv = void 0, this.maxLab.rzsv = void 0 }, initHandles: function () { this.updateLowHandle(this.valueToOffset(this.scope.rzSliderModel)), this.range && (this.updateHighHandle(this.valueToOffset(this.scope.rzSliderHigh)), this.updateCmbLabel()), this.updateSelectionBar() }, translateFn: function (t, e, i) { i = void 0 === i?!0:i; var n = (i?this.customTrFn(t):t) + "", s = !1; (void 0 === e.rzsv || e.rzsv.length !== n.length || e.rzsv.length > 0 && 0 === e.rzsw) && (s = !0, e.rzsv = n), e.text(n), s && this.getWidth(e) }, setMinAndMax: function () { this.minValue = this.scope.rzSliderFloor?+this.scope.rzSliderFloor:this.scope.rzSliderFloor = 0, this.scope.rzSliderCeil?this.maxValue = +this.scope.rzSliderCeil:this.scope.rzSliderCeil = this.maxValue = this.range?this.scope.rzSliderHigh:this.scope.rzSliderModel, this.scope.rzSliderStep && (this.step = +this.scope.rzSliderStep), this.valueRange = this.maxValue - this.minValue }, initElemHandles: function () { angular.forEach(this.sliderElem.children(), function (t, e) { var i = angular.element(t); switch (e) {case 0: this.fullBar = i; break;case 1: this.selBar = i; break;case 2: this.minH = i; break;case 3: this.maxH = i; break;case 4: this.flrLab = i; break;case 5: this.ceilLab = i; break;case 6: this.minLab = i; break;case 7: this.maxLab = i; break;case 8: this.cmbLab = i} }, this), this.fullBar.rzsl = 0, this.selBar.rzsl = 0, this.minH.rzsl = 0, this.maxH.rzsl = 0, this.flrLab.rzsl = 0, this.ceilLab.rzsl = 0, this.minLab.rzsl = 0, this.maxLab.rzsl = 0, this.cmbLab.rzsl = 0, this.hideLimitLabels && (this.flrLab.rzAlwaysHide = !0, this.ceilLab.rzAlwaysHide = !0, this.hideEl(this.flrLab), this.hideEl(this.ceilLab)), this.range === !1 && (this.cmbLab.remove(), this.maxLab.remove(), this.maxH.rzAlwaysHide = !0, this.maxH[0].style.zIndex = "-1000", this.hideEl(this.maxH)), this.range === !1 && this.alwaysShowBar === !1 && (this.maxH.remove(), this.selBar.remove()) }, calcViewDimensions: function () { var t = this.getWidth(this.minH); this.handleHalfWidth = t / 2, this.barWidth = this.getWidth(this.fullBar), this.maxLeft = this.barWidth - t, this.getWidth(this.sliderElem), this.sliderElem.rzsl = this.sliderElem[0].getBoundingClientRect().left, this.initHasRun && (this.updateCeilLab(), this.initHandles()) }, updateCeilLab: function () { this.translateFn(this.scope.rzSliderCeil, this.ceilLab), this.setLeft(this.ceilLab, this.barWidth - this.ceilLab.rzsw), this.getWidth(this.ceilLab) }, updateFloorLab: function () { this.translateFn(this.scope.rzSliderFloor, this.flrLab), this.getWidth(this.flrLab) }, updateHandles: function (t, e) { return "rzSliderModel" === t?(this.updateLowHandle(e), this.updateSelectionBar(), void (this.range && this.updateCmbLabel())):"rzSliderHigh" === t?(this.updateHighHandle(e), this.updateSelectionBar(), void (this.range && this.updateCmbLabel())):(this.updateLowHandle(e), this.updateHighHandle(e), this.updateSelectionBar(), void this.updateCmbLabel()) }, updateLowHandle: function (t) { var e = Math.abs(this.minH.rzsl - t); this.minLab.rzsv && 0 >= e && 1 > e || (this.setLeft(this.minH, t), this.translateFn(this.scope.rzSliderModel, this.minLab), this.setLeft(this.minLab, t - this.minLab.rzsw / 2 + this.handleHalfWidth), this.shFloorCeil()) }, updateHighHandle: function (t) { this.setLeft(this.maxH, t), this.translateFn(this.scope.rzSliderHigh, this.maxLab), this.setLeft(this.maxLab, t - this.maxLab.rzsw / 2 + this.handleHalfWidth), this.shFloorCeil() }, shFloorCeil: function () { var t = !1, e = !1; this.minLab.rzsl > this.flrLab.rzsl + this.flrLab.rzsw + 5?(t = !1, this.showEl(this.flrLab)):(t = !0, this.hideEl(this.flrLab)), this.minLab.rzsl + this.minLab.rzsw < this.ceilLab.rzsl - this.handleHalfWidth - 10?(e = !1, this.showEl(this.ceilLab)):(e = !0, this.hideEl(this.ceilLab)), this.range && (this.maxLab.rzsl + this.maxLab.rzsw < this.ceilLab.rzsl - 10?e || this.showEl(this.ceilLab):this.hideEl(this.ceilLab), this.maxLab.rzsl > this.flrLab.rzsl + this.flrLab.rzsw + this.handleHalfWidth?t || this.showEl(this.flrLab):this.hideEl(this.flrLab)) }, updateSelectionBar: function () { this.setWidth(this.selBar, Math.abs(this.maxH.rzsl - this.minH.rzsl)), this.setLeft(this.selBar, this.range?this.minH.rzsl + this.handleHalfWidth:0) }, updateCmbLabel: function () { var t, e; this.minLab.rzsl + this.minLab.rzsw + 10 < this.maxLab.rzsl?(this.showEl(this.maxLab), this.showEl(this.minLab), this.hideEl(this.cmbLab)):(this.customTrFn?(t = this.customTrFn(this.scope.rzSliderModel), e = this.customTrFn(this.scope.rzSliderHigh)):(t = this.scope.rzSliderModel, e = this.scope.rzSliderHigh), this.translateFn(t + " - " + e, this.cmbLab, !1), this.setLeft(this.cmbLab, this.selBar.rzsl + this.selBar.rzsw / 2 - this.cmbLab.rzsw / 2), this.hideEl(this.minLab), this.hideEl(this.maxLab), this.showEl(this.cmbLab)) }, roundStep: function (t) { var e = this.step, i = +((t - this.minValue) % e).toFixed(3), n = i > e / 2?t + e - i:t - i; return n = n.toFixed(this.precision), +n }, hideEl: function (t) { return t.css({ opacity: 0 }) }, showEl: function (t) { return t.rzAlwaysHide?t:t.css({ opacity: 1 }) }, setLeft: function (t, e) { return t.rzsl = e, t.css({ left: e + "px" }), e }, getWidth: function (t) { var e = t[0].getBoundingClientRect(); return t.rzsw = e.right - e.left, t.rzsw }, setWidth: function (t, e) { return t.rzsw = e, t.css({ width: e + "px" }), e }, valueToOffset: function (t) { return (t - this.minValue) * this.maxLeft / this.valueRange }, offsetToValue: function (t) { return t / this.maxLeft * this.valueRange + this.minValue }, bindEvents: function () { this.minH.on("mousedown", angular.bind(this, this.onStart, this.minH, "rzSliderModel")), this.range && this.maxH.on("mousedown", angular.bind(this, this.onStart, this.maxH, "rzSliderHigh")), this.fullBar.on("mousedown", angular.bind(this, this.onStart, this.fullBar, "rzSliderModel")), this.fullBar.on("mousedown", angular.bind(this, this.onMove, this.fullBar)), this.selBar.on("mousedown", angular.bind(this, this.onStart, this.selBar, "rzSliderModel")), this.selBar.on("mousedown", angular.bind(this, this.onMove, this.selBar)), this.minH.on("touchstart", angular.bind(this, this.onStart, this.minH, "rzSliderModel")), this.range && this.maxH.on("touchstart", angular.bind(this, this.onStart, this.maxH, "rzSliderHigh")), this.fullBar.on("touchstart", angular.bind(this, this.onStart, this.fullBar, "rzSliderModel")), this.fullBar.on("touchstart", angular.bind(this, this.onMove, this.fullBar)), this.selBar.on("touchstart", angular.bind(this, this.onStart, this.selBar, "rzSliderModel")), this.selBar.on("touchstart", angular.bind(this, this.onMove, this.selBar)) }, onStart: function (t, i, n) { var s, r, a = this.getEventNames(n); n.stopPropagation(), n.preventDefault(), "" === this.tracking && (this.calcViewDimensions(), this.tracking = i, t.addClass("rz-active"), s = angular.bind(this, this.onMove, t), r = angular.bind(this, this.onEnd, s), e.on(a.moveEvent, s), e.one(a.endEvent, r)) }, onMove: function (t, e) { var i, n, s, r; return i = "clientX" in e?e.clientX:void 0 === e.originalEvent?e.touches[0].clientX:e.originalEvent.touches[0].clientX, n = this.sliderElem.rzsl, s = i - n - this.handleHalfWidth, s > 0?s < this.maxLeft?(r = this.offsetToValue(s), r = this.roundStep(r), s = this.valueToOffset(r), this.range && ("rzSliderModel" !== this.tracking || r < this.scope.rzSliderHigh?"rzSliderHigh" !== this.tracking || r > this.scope.rzSliderModel || (this.scope[this.tracking] = this.scope.rzSliderModel, this.updateHandles(this.tracking, this.minH.rzsl), this.tracking = "rzSliderModel", this.maxH.removeClass("rz-active"), this.minH.addClass("rz-active")):(this.scope[this.tracking] = this.scope.rzSliderHigh, this.updateHandles(this.tracking, this.maxH.rzsl), this.tracking = "rzSliderHigh", this.minH.removeClass("rz-active"), this.maxH.addClass("rz-active"))), void (this.scope[this.tracking] !== r && (this.scope[this.tracking] = r, this.updateHandles(this.tracking, s), this.scope.$apply()))):void (t.rzsl !== this.maxLeft && (this.scope[this.tracking] = this.maxValue, this.updateHandles(this.tracking, this.maxLeft), this.scope.$apply())):void (0 !== t.rzsl && (this.scope[this.tracking] = this.minValue, this.updateHandles(this.tracking, 0), this.scope.$apply())) }, onEnd: function (t, i) { var n = this.getEventNames(i).moveEvent; this.minH.removeClass("rz-active"), this.maxH.removeClass("rz-active"), e.off(n, t), this.scope.$emit("slideEnded"), this.tracking = "" }, getEventNames: function (t) { var e = { moveEvent: "", endEvent: "" }; return t.touches || void 0 !== t.originalEvent && t.originalEvent.touches?(e.moveEvent = "touchmove", e.endEvent = "touchend"):(e.moveEvent = "mousemove", e.endEvent = "mouseup"), e } }, s }]).directive("rzslider", ["RzSlider", function (t) { "use strict"; return { restrict: "E", scope: { rzSliderFloor: "=?", rzSliderCeil: "=?", rzSliderStep: "@", rzSliderPrecision: "@", rzSliderModel: "=?", rzSliderHigh: "=?", rzSliderTranslate: "&", rzSliderHideLimitLabels: "=?", rzSliderAlwaysShowBar: "=?", rzSliderPresentOnly: "@" }, templateUrl: function (t, e) { return e.rzSliderTplUrl || "rzSliderTpl.html" }, link: function (e, i, n) { return new t(e, i, n) } } }]);